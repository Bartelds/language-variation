<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html40/loose.dtd">
<html>
<head>
  <title>RuG/L04 - Manuals - Map configuration file</title>
  <link rel="stylesheet" type="text/css" href="manuals.css">
</head>
<body>

<center>
<H1><a href="http://www.let.rug.nl/~kleiweg/L04/"><img src="RuG-L04.gif" alt="RuG/L04" border="0"></a></H1>
<h2>Manuals</h2>
<h3>Map configuration file</h3>
</center>

<div class="text">
This document describes the format of the configuration file that is
used by the programs
<a href="mapclust.html">mapclust</a>,
<a href="mapdiff.html">mapdiff</a>,
<a href="maplink.html">maplink</a>,
<a href="mapmap.html">mapmap</a>,
<a href="maprgb.html">maprgb</a>, and
<a href="mapvec.html">mapvec</a>.
<p>
See also: <a href="example.cfg">example.cfg</a>
<p>
See <a href="mapmap.html">mapmap</a> for testing.
</div>

<h4>Syntax</h4>

<div class="text">
The configuration file consist of a collection of settings. Each setting
consists of a name in lower case followed by a colon, followed by one or
more values. There may be no space before the colon. Settings without
values are ignored. Example:
<pre>
    # comment lines and empty lines are ignored

    # 'name' is set to 'value'
    name: value

    # no value, ignored
    anothername:
</pre>
<p>
A remark on filenames: Any  filenames without an absolute pathname  are
resolved relative to the directory in which the program is run, not
relative to the directory in which the configuration file resides.
<p>
A remarks on sizes: all absolute sizes are in PostScript points. 72
points is equal to 1 inch.
</div>

<h4>Required settings</h4>

<div class="text">
Three files should be defined:
<dl>
<dt><tt><a name="transform">transform:</a></tt>
  <dd>value: filename<br>
The name of a file with a piece of PostScript code defining a linear transform
  function, named <tt><b>Map</b></tt>, that translates a pair of map
  coordinates into a pair of image coordinates.<br>
You can use the <a href="mapsetup.html">mapsetup</a> program to create
  this file.
<p>
<dt><tt>labels:</tt>
  <dd>value: filename<br>
The name of a <a href="formats.html#lbl">label file</a>.
<p>
<dt><tt>coordinates:</tt>
  <dd>value: filename<br>
The name of a <a href="formats.html#coo">coordinate file</a>.
</dl>

</div>
<p>

<h4>Optional settings</h4>

<div class="text">
Three more files:
<dl>
<dt><tt><a name="clipping">clipping:</a></tt>
  <dd>value: filename<br>
default: none<br>
The name of a file with a piece of PostScript code defining the clipping
 region. Only the area within this region will be painted.<br>
You can use the <a href="mapsetup.html">mapsetup</a> program to create
  this file.
<p>
<dt><tt>map:</tt>
  <dd>value: filename<br>
default: none<br>
The name of a file with a piece of PostScript code for drawing the lines
  of the map, such as borders.<br>
You can use the <a href="mapsetup.html">mapsetup</a> program to create
  this file.
<p>
<a name="othermarkers"></a>
<dt><tt>othermarkers:</tt>
  <dd>value: filename<br>
default: none<br>
The name of a file with a list of locations that should be treated
  differently from the general settings, as defined by the option
  <a href="#markers">markers</a>.
Each line in the file has a value followed by a label, separated by space(s) or
  tab(s).<br>
The label is the name of
  a location, as defined in the label file.<br>
The value says what to do
  with this location.<br>
If the value is -1, the location should be ignored completely. This is
  particularly useful if you have two locations with identical
  coordinates, since only one result per location can be shown anyway, and the
  algorithm for triangulation (dividing the map into regions surrounding
  each location) may fail on identical locations.<br>
If the value is zero or positive, an integer value from 0 to 255 inclusive, it
  is meant as a substitute for the default marker setting. The value is
  the sum of zero or more of these numbers:<br>
1: put dot<br>
2: put location number<br>
4: put label<br>
8: draw polygon<br>
16: put cluster symbol (mapclust only)<br>
32: put cluster number (mapclust only)<br>
64: draw data island (mapclust, mapmap, maprgb)<br>
128: draw data island as diamond (requires 64 as well)<br>
For data island, see also options <a href="#islandr">islandr</a> and
 <a href="#islandlw">islandlw</a>.<br>
With <a href="mapdiff.html">mapdiff</a>, the number 64 has the same effect as
 value -1. In other words, data from islands is ignored completely.
</dl>
<p>
Other settings:
<p>

<dl>
<dt><tt>backrgb:</tt>
<dd>value: three real numbers between 0 and 1<br>
default: .9 .9 .9<br>
These are the red, green and blue colour components for the background
colour. This colour is used for areas of the map for which no data is
available.
<p>
<dt><tt>aspect:</tt>
  <dd>value: a real number, 1 or greater<br>
default: 1<br>
This value defines the aspect ratio between the horizontal and vertical
coordinates. Useful if you are using coordinates defined as longitude and
latitude. The program <a href="mapsetup.html">mapsetup</a> can give
you a useful value.<br>
Coordinates are always used in a rectangular grid. You won't get curved
lines along the longitude. If the distortion is unacceptable, you may
want to translate all coordinates to some rectangular representation,
such as UTM coordinates.
<p>
<dt><tt><a name="markers">markers:</a></tt>
<dd>value, zero or more of: <tt>dot</tt> <tt>label</tt> <tt>number</tt> <tt>poly</tt><br>
default: nothing<br>
This determines how locations are marked on the map. You should not combine
<tt>dot</tt> and <tt>number</tt>.<br>
If you define <tt>label</tt> the names of the locations are printed.
Where each label is positioned is determined by the third and fourth
number in the <a href="formats.html#coo">coordinate file</a>. These two
values are called <tt>dx</tt> and <tt>dy</tt>. A <tt>dx</tt> value of -1
means the label will be put left of the coordinates of the location. If
the value is 1, it will be put at the right side. Any value in between
will shift the label somewhere in between. You can use values outside
the range -1 to 1 to move the label further away. The value for
<tt>dy</tt> determines the vertical position. -1 means below, 1 means
above the location. You may run the programs for creating maps several
times, and based on the results adjust the <tt>dx</tt> and <tt>dy</tt>
values in the coordinate file to get the labels positioned so they won't overlap.
<p>
<dt><tt>missing:</tt>
<dd>value, one of: <tt>ignore</tt> <tt>preserve</tt><br>
default: <tt>preserve</tt><br>
The label file and the coordinate file should define the same set of locations.
However, the datafile (the cluster file used by mapclust, or the vector file used
by maprgb)  can use a smaller set of locations. This options
determines what happens to the locations that are not present in the
datafile.<br>
<tt>ignore</tt>: The program will act as if the locations don't exist. Their
space will be occupied by locations that do exist (have data).<br>
<tt>preserve</tt>: The program will leave the areas for the locations with missing
data open, creating gaps on the map.
<p>
<dt><tt>fillmargin:</tt>
<dd>value: a positive value<br>
<dd>default: 0.5<br>
This value determines how far painting extends beyond the extreme locations, as
a fraction of the distance between the extreme locations.<br>
Increase this value if parts along the edge of the map are not painted.
<p>
<dt><tt><a name="limit">limit:</a></tt>
<dd>value: a positive value<br>
<dd>default: 50<br>
If you don't have a <a href="#clipping">clipping</a> file, or if the
value of <a href="#uselimit">uselimit</a> is <tt>yes</tt>,
this value
will be used to limit the area around each location that is painted. The
value is the radius of the circle centred around the location to which
painting will be restricted.<br>
It might be best to start with a small value, such as 10, then draw a
map, and increase the value if there are gaps left between the locations.
<p>
<dt><tt><a name="uselimit">uselimit:</a></tt>
<dd>value, one of: <tt>yes</tt> <tt>no</tt><br>
If <tt>yes</tt>, <a href="#limit">limit</a> the area around each location that is painted, even if you
do have a  <a href="#clipping">clipping</a> file.<br>
<dt><tt>boundingbox:</tt>
<dd>value: four integer numbers<br>
<dd>default: 0 0 595 842<br>
These four values determine the outer boundaries of the image. The
image created is Encapsulated PostScript, meaning, the image can be
imported into other documents. This only works correctly if the
boundingbox is set correct, so the importing program knows how large the
image is, and how it is positioned.<br>
The four numbers are: the left x-coordinate, the bottom y-coordinate,
the right x-coordinate, the top x-coordinate.<br>
You can view an image with a program like GSview or GV, and use your
mouse to point at the borders. The coordinates will be displayed by the
program. (These programs themselves can use the boundingbox values to
crop the displayed images.)<br>
It is best to set the boundingbox last, once all other options are
tested and have their final settings. Changing values in the
<a href="#transform">transform file</a> also effects the size of the
image.
<p>
<dt><tt>fontname:</tt>
<dd>value: a valid fontname known to PostScript<br>
default: Helvetica<br>
Fonts that can be used include, serif:
<tt>Times-Roman</tt>,
<tt>Times-Bold</tt>,
<tt>Times-Italic</tt>,
<tt>Times-BoldItalic</tt>;
sans serif:
<tt>Helvetica</tt>,
<tt>Helvetica-Bold</tt>,
<tt>Helvetica-Oblique</tt>,
<tt>Helvetica-BoldOblique</tt>;
mono spaced:
<tt>Courier</tt>,
<tt>Courier-Bold</tt>,
<tt>Courier-Oblique</tt>,
<tt>Courier-BoldOblique</tt>.
<p>
<dt><tt>fontmatrix:</tt>
<dd>value: font matrix<br>
default: [ 8 0 0 8 0 0 ]<br>
Actually, this can be any PostScript code that returns a font matrix. To
put it simple, if you want a font of size 10, use:
<pre>
    [ 10 0 0 10 0 0 ]
</pre>
If you want a font scaled 10 in height but only 8 in width, use:
<pre>
    [ 8 0 0 10 0 0 ]
</pre>
Unless you want a slanted, rotated or otherwise distorted font, don't
change the zeros.
<p>
<dt><tt>pslevel:</tt>
<dd>value: 1 or 2<br>
default: 1<br>
This option determines what PostScript language level to use. Level 1 is
very old, and the chance it is still in use is minimal. If you choose
level 2 the file will be slightly smaller. If you choose level 1, the
result will work on both level 1 and level 2 PostScript devices. Note that if you use patterns
with <a href="mapclust.html">mapclust</a> (option -p), the setting will be changed
to level 2 automaticly, and the result won't work on a level 1
PostScript device.
<p>
<dt><tt>fillstyle:</tt>
<dd>value: fill or eofill<br>
default: fill<br>
Change the rule for filling and clipping:<br>
fill: Non-zero winding number rule<br>
eofill: Even-odd rule
<p>
<dt><tt>radius:</tt>
<dd>value: a positive real number<br>
default: 2.5<br>
This is the size of the black dots, if you use dot <a href="#markers">markers</a>.
<p>
<dt><tt>white:</tt>
<dd>value: a positive real number<br>
default: 1<br>
This is the width of the white line around the black dots, if you use
dot <a href="#markers">markers</a>.
<p>
<dt><tt>xgap:</tt>
<dd>value: a positive real number or 0<br>
default: 4<br>
This is the amount of horizontal space a label is set from the centre of
the location
if the dx position is set to -1 or 1. See <a href="#markers">markers</a>.
<p>
<dt><tt>ygap:</tt>
<dd>value: a positive real number or 0<br>
default: 4<br>
This is the amount of vertical space a label is set from the centre of
the location
if the dy position is set to -1 or 1. See <a href="#markers">markers</a>.
<p>
<dt><tt>linewidth:</tt>
<dd>value: a positive real number<br>
default: .5<br>
The line width used when drawing polygons.
See <a href="#markers">markers</a>.
<p>
<dt><a name="islandr"></a><tt>islandr:</tt>
<dd>value: a positive real number<br>
default: 10<br>
The radius of markers used for data islands.
See also <a href="#othermarkers">othermarkers</a>.
<p>
<dt><a name="islandlw"></a><tt>islandlw:</tt>
<dd>value: a non-negative real number<br>
default: 1<br>
Line width for markers of data islands. If this value is 0, no line will be drawn.
See also <a href="#othermarkers">othermarkers</a>.
</dl>
</div>

<h4>Options for <tt>mapclust</tt> only</h4>

<div class="text">
<dl>
<dt><tt>borderwidth:</tt>
<dd>value: a positive real number<br>
default: 2<br>
This is the line width for borders between clusters.
For <a href="maplink.html">maplink</a>, this is the width of the links.
<p>
<dt><tt>borderrgb:</tt>
<dd>value: three real numbers between 0 and 1<br>
default: 0 0 1<br>
These are the red, green and blue colour components for the borders
between clusters.
<p>
<dt><tt>symbolsize:</tt>
<dd>value: a positive real number<br>
default: 5<br>
This is the size of symbols.
<p>
<dt><tt>symbollinewidth:</tt>
<dd>value: a positive real number<br>
default: .3<br>
This is the line width used in symbols.
</dl>
</div>

<h4>Further...</h4>

<div class="text">
The PostScript files created by the map programs are highly structured. Settings are documented. If you
know something about PostScript, you can read and edit these files for
fine tuning, or adding things. Things you should look at in particular
are the function <tt>Map</tt> which is included at the top of the file
between a <tt>%%BeginDocument</tt> / <tt>%%EndDocument</tt> pair,
several setting that follow immediately, and the array named <tt>PP</tt>
a bit further down.
</div>
<p>

</BODY>
</HTML>
